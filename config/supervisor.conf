[supervisord]
logfile=logs/supervisord.log
logfile_maxbytes=50MB
logfile_backups=5
loglevel=info
pidfile=logs/supervisord.pid
nodaemon=false

[supervisorctl]
serverurl=unix:///tmp/jarvis_v2_supervisor.sock

[unix_http_server]
file=/tmp/jarvis_v2_supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[program:learning_worker]
command=%(here)s/../venv/bin/python -m jarvis.workers.learning
directory=%(here)s/..
autostart=true
autorestart=true
startsecs=5
stopwaitsecs=30
stdout_logfile=logs/learning_worker_out.log
stderr_logfile=logs/learning_worker_err.log
environment=PYTHONPATH="%(here)s/.."

[program:research_worker]
command=%(here)s/../venv/bin/python -m jarvis.workers.research
directory=%(here)s/..
autostart=true
autorestart=true
startsecs=5
stopwaitsecs=30
stdout_logfile=logs/research_worker_out.log
stderr_logfile=logs/research_worker_err.log
environment=PYTHONPATH="%(here)s/.."

[program:health_worker]
command=%(here)s/../venv/bin/python -m jarvis.workers.health
directory=%(here)s/..
autostart=true
autorestart=true
startsecs=5
stopwaitsecs=30
stdout_logfile=logs/health_worker_out.log
stderr_logfile=logs/health_worker_err.log
environment=PYTHONPATH="%(here)s/.."

[program:trading_worker]
command=%(here)s/../venv/bin/python -m jarvis.workers.trading
directory=%(here)s/..
autostart=true
autorestart=true
startsecs=5
stopwaitsecs=30
stdout_logfile=logs/trading_worker_out.log
stderr_logfile=logs/trading_worker_err.log
environment=PYTHONPATH="%(here)s/.."

[program:api_server]
command=%(here)s/../venv/bin/uvicorn jarvis.api.server:app --host 0.0.0.0 --port 8504
directory=%(here)s/..
autostart=true
autorestart=true
startsecs=5
stdout_logfile=logs/api_server_out.log
stderr_logfile=logs/api_server_err.log
environment=PYTHONPATH="%(here)s/.."

[group:jarvis_v2]
programs=learning_worker,research_worker,health_worker,trading_worker,api_server
